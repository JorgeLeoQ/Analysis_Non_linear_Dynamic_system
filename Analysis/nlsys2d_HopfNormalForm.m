function out = nlsys2d_HopfNormalForm

out{1} = @init;
out{2} = @fun_eval;
out{3} = @jacobian;
out{4} = @jacobianp;
out{5} = @hessians;
out{6} = @hessiansp;
out{7} = [];%@der3;
out{8} = [];
out{9} = [];

% --------------------------------------------------------------------------
function dydt = fun_eval(t,x,p1,p2)
p2 = 0;
Minf = 0.5*(1 + tanh((x(1)+1.2)/18));

dydt=[0.2*(-2*(x(1)+60)-4*Minf.*(x(1)-120)-8*x(2)*(x(1)+80)+p1);
     ((cosh((x(1)-p2)/34.8))*(0.5*(1+tanh((x(1)-p2)/17.4))-x(2)))/15;];



% --------------------------------------------------------------------------
function [tspan,y0,options] = init
handles = feval(nlsys2d_HopfNormalForm);
y0=[0,0];
options = odeset('Jacobian',handles(3),'JacobianP',handles(4),'Hessians',handles(5),'HessiansP',handles(6));
tspan = [0 10];

% --------------------------------------------------------------------------
function jac = jacobian(t,x,p1,p2)
p2 = 0;
jac=[[(-2/5) * (1+(1/18) * (1-tanh((x(1)+1.2)/18)^2)*(x(1)-120)+1+tanh((x(1)+1.2)/18)+4*x(2)),(-8/5)*(x(1)+80)];
    [(1/30)*((1/34.8)*sinh((x(1)-p2)/34.8)*(1+tanh((x(1)-p2)/17.4)-2*x(2))+(1/17.4)*cosh((x(1)-p2)/34.8)*(1-tanh((x(1)-p2)/17.4)^2)),(-1/15)*cosh((x(1)-p2)/34.8)]];
% --------------------------------------------------------------------------
function jacp = jacobianp(t,x,p1,p2)
p2 = 0;
jacp=[[1/5,0];[0,(cosh((5*p2)/174 - (5*x(1))/174)*((5*tanh((5*p2)/87 - (5*x(1))/87)^2)/174 - 5/174))/15 - (sinh((5*p2)/174 - (5*x(1))/174)*(x(2) + tanh((5*p2)/87 - (5*x(1))/87)/2 - 1/2))/522]];
% --------------------------------------------------------------------------
function hess = hessians(t,x,p1,p2)
p2 = 0;
hess1=[[(2*tanh(x(1)/18 + 1/15)^2)/45 - (2*tanh(x(1)/18 + 1/15)*(tanh(x(1)/18 + 1/15)^2/18 - 1/18)*(x(1) - 120))/45 - 2/45,-8/5];[-8/5,0]];
hess2=[[(sinh((5*p2)/174 - (5*x(1))/174)*((5*tanh((5*p2)/87 - (5*x(1))/87)^2)/174 - 5/174))/261 - (5*cosh((5*p2)/174 - (5*x(1))/174)*(x2 + tanh((5*p2)/87 - (5*x(1))/87)/2 - 1/2))/90828 - (cosh((5*p2)/174 - (5*x(1))/174)*tanh((5*p2)/87 - (5*x(1))/87)*((5*tanh((5*p2)/87 - (5*x(1))/87)^2)/87 - 5/87))/261,sinh((5*p2)/174 - (5*x(1))/174)/522];[sinh((5*p2)/174 - (5*x(1))/174)/522,0]];
hess(:,:,1) =hess1;
hess(:,:,2) =hess2;
% --------------------------------------------------------------------------
function hessp = hessiansp(t,x,p1,p2)
p2 = 0;
hessp1=[[0,0];[0,0]];
hessp2=[[0,0];[0,(sinh((5*p2)/174 - (5*x(1))/174)*((5*tanh((5*p2)/87 - (5*x(1))/87)^2)/174 - 5/174))/261 - (5*cosh((5*p2)/174 - (5*x(1))/174)*(x(2) + tanh((5*p2)/87 - (5*x(1))/87)/2 - 1/2))/90828 - (cosh((5*p2)/174 - (5*x(1))/174)*tanh((5*p2)/87 - (5*x(1))/87)*((5*tanh((5*p2)/87 - (5*x(1))/87)^2)/87 - 5/87))/261]];
hessp(:,:,1) =hessp1;
hessp(:,:,2) =hessp2;
%---------------------------------------------------------------------------
% function tens3  = der3(t,kmrgd,y,z)
% tens31=[[20/3*(20/3-20/3*tanh(20/3*kmrgd(1)+1/15)^2)^2*(kmrgd(1)-1)-800/9*tanh(20/3*kmrgd(1)+1/15)^2*(20/3-20/3*tanh(20/3*kmrgd(1)+1/15)^2)*(kmrgd(1)-1)+20*tanh(20/3*kmrgd(1)+1/15)*(20/3-20/3*tanh(20/3*kmrgd(1)+1/15)^2),0];[-230/29*(-200/29+200/29*tanh(-200/29*kmrgd(1)+200/29*z)^2)^2*cosh(100/29*kmrgd(1)-10/29)-92000/841*tanh(-200/29*kmrgd(1)+200/29*z)^2*(-200/29+200/29*tanh(-200/29*kmrgd(1)+200/29*z)^2)*cosh(100/29*kmrgd(1)-10/29)-69000/841*tanh(-200/29*kmrgd(1)+200/29*z)*(-200/29+200/29*tanh(-200/29*kmrgd(1)+200/29*z)^2)*sinh(100/29*kmrgd(1)-10/29)+30000/841*(115/29-115/29*tanh(-200/29*kmrgd(1)+200/29*z)^2)*cosh(100/29*kmrgd(1)-10/29)+1000000/24389*(23/40-23/40*tanh(-200/29*kmrgd(1)+200/29*z)-23/20*kmrgd(2))*sinh(100/29*kmrgd(1)-10/29),-11500/841*cosh(100/29*kmrgd(1)-10/29)]];
% tens32=[[0,0];[-11500/841*cosh(100/29*kmrgd(1)-10/29),0]];
% tens33=[[0,0];[-11500/841*cosh(100/29*kmrgd(1)-10/29),0]];
% tens34=[[0,0];[0,0]];
% tens3(:,:,1,1) =tens31;
% tens3(:,:,1,2) =tens32;
% tens3(:,:,2,1) =tens33;
% tens3(:,:,2,2) =tens34;
%---------------------------------------------------------------------------
%function tens4  = der4(t,x,p1,p2)
%---------------------------------------------------------------------------
%function tens5  = der5(t,x,p1,p2)
